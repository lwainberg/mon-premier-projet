---
const navLinks = [
  { href: '/#features',    label: 'Features'    },
  { href: '/#technology',  label: 'Technology'  },
  { href: '/#about',       label: 'About'       },
];

const currentPath = Astro.url.pathname;
---

<header
  id="site-header"
  class="sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-surface-100 transition-shadow duration-300"
>
  <nav
    class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between gap-8"
    aria-label="Main navigation"
  >

    <!-- ── Logo ─────────────────────────────────────────────────────────── -->
    <a href="/" class="flex-shrink-0 focus-visible:rounded-md" aria-label="Facetview — Home">
      <img
        src="/assets/logo-facetview.svg"
        alt="Facetview"
        height="34"
        class="h-[34px] w-auto"
      />
    </a>

    <!-- ── Liens desktop ─────────────────────────────────────────────────── -->
    <ul class="hidden md:flex items-center gap-1" role="list">
      {navLinks.map(({ href, label }) => (
        <li>
          <a
            href={href}
            class:list={[
              'px-3 py-2 rounded-md text-sm font-medium transition-colors',
              currentPath === href
                ? 'text-brand-700 bg-brand-50'
                : 'text-surface-600 hover:text-brand-700 hover:bg-surface-50',
            ]}
          >
            {label}
          </a>
        </li>
      ))}
    </ul>

    <!-- ── Actions ───────────────────────────────────────────────────────── -->
    <div class="flex items-center gap-3">

      <!-- CTA desktop -->
      <a
        href="mailto:keyur@facetview.net?subject=Demo%20Request"
        class="hidden sm:inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold text-white bg-brand-700 rounded-lg hover:bg-brand-800 active:bg-brand-900 transition-colors shadow-sm"
      >
        Get a Demo
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
          <path fill-rule="evenodd" d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd"/>
        </svg>
      </a>

      <!-- Hamburger mobile -->
      <button
        id="mobile-menu-btn"
        type="button"
        class="md:hidden p-2 rounded-md text-surface-600 hover:text-brand-700 hover:bg-surface-50 transition-colors"
        aria-expanded="false"
        aria-controls="mobile-menu"
        aria-label="Toggle menu"
      >
        <svg id="icon-menu" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
        <svg id="icon-close" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>

    </div>
  </nav>

  <!-- ── Menu mobile ───────────────────────────────────────────────────────── -->
  <div
    id="mobile-menu"
    class="hidden md:hidden border-t border-surface-100 bg-white"
    role="dialog"
    aria-label="Mobile navigation"
  >
    <ul class="px-4 py-3 space-y-1" role="list">
      {navLinks.map(({ href, label }) => (
        <li>
          <a
            href={href}
            class="block px-3 py-2 rounded-md text-sm font-medium text-surface-700 hover:text-brand-700 hover:bg-surface-50 transition-colors"
          >
            {label}
          </a>
        </li>
      ))}
      <li class="pt-2 border-t border-surface-100">
        <a
          href="mailto:keyur@facetview.net?subject=Demo%20Request"
          class="block px-3 py-2 rounded-md text-sm font-semibold text-white bg-brand-700 hover:bg-brand-800 transition-colors text-center"
        >
          Get a Demo
        </a>
      </li>
    </ul>
  </div>
</header>

<script>
  const btn   = document.getElementById('mobile-menu-btn')!;
  const menu  = document.getElementById('mobile-menu')!;
  const iMenu = document.getElementById('icon-menu')!;
  const iClose = document.getElementById('icon-close')!;

  btn.addEventListener('click', () => {
    const isOpen = menu.classList.toggle('hidden') === false;
    btn.setAttribute('aria-expanded', String(isOpen));
    iMenu.classList.toggle('hidden', isOpen);
    iClose.classList.toggle('hidden', !isOpen);
  });

  // Fermer le menu au clic sur un lien mobile
  menu.querySelectorAll('a').forEach(a =>
    a.addEventListener('click', () => {
      menu.classList.add('hidden');
      btn.setAttribute('aria-expanded', 'false');
      iMenu.classList.remove('hidden');
      iClose.classList.add('hidden');
    })
  );
</script>
